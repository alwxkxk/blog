---
title: 部署到云服务器
toc: true
abbrlink: 31687
date: 2021-07-28 18:33:28
tags:
---

&emsp;在阅读本篇文章之前，你已经阅读了：
- [软硬结合-导读](/posts/44755)
- [NodeMCU基础](/posts/31494)
- [demo1跑起来](/posts/64786/)
- [demo2跑起来](/posts/64786/)

## 本篇学习内容
- 购买云服务器（以腾讯云为例），并以终端连接上去
- 在Linux上安装部署demo1项目并验证
- 在Linux上安装部署demo2项目并验证

## 购买云服务器
&emsp;由于云服务器价格比较贵，所以一般是能省就省，不会使用图形化界面，大多是敲命令行。
&emsp;首先要购买云服务器，一般大家都是新人，所以有新人优惠，别傻傻地原价买：[1核2G云服务器首年99元（3年303元）](https://cloud.tencent.com/act/new?fromSource=gwzcw.4325959.4325959.4325959&utm_medium=cps&utm_id=gwzcw.4325959.4325959.4325959&cps_key=baa84ded7a9778d3aa1addcd4fbb8b24)优惠只有一次，平均下来不到10块钱一个月，比买奶茶还便宜，绝对是亏本价。（PS：我个人是买三年的，因为这种新人优惠机会只有一次。）

&emsp;使用完新人价后，还有低于25岁的可以直接去验证为学生并以学生价继续买（大于25岁的就需要输入学生证了）：
[学生价1核2G云服务器3个月27元（一年108元）](https://cloud.tencent.com/act/campus?fromSource=gwzcw.4325959.4325959.4325959&utm_medium=cps&utm_id=gwzcw.4325959.4325959.4325959&cps_key=baa84ded7a9778d3aa1addcd4fbb8b24)，在学生期间最多优惠三次。

![学生优惠](/blog_images/学生优惠.png)

&emsp;如果各位学生仅仅是试试水，不想花100块钱，那么建议学生价用那3个月的，才24块钱对于学生来说也不贵。（大于25岁的没有学生优惠的就没办法，只能选一年的新人价，但对于已经工作的人来说，一百多不算贵）

## 跟我敲命令
&emsp;由于绝大部分人都没有学过linux，所以我这里直接演示，大家跟着操作，并且我每操作一个命令，后续都再操作一个验证命令，验证你是跟着操作并且是对了的，你就可以安心地跟着继续敲下一个命令。

### 把demo1跑起来
&emsp;使用网页的官方终端

&emsp;在安全组设置开放端口，并使用`ping`验证一下端口是否开通。

```bash
# 切换到拥有最高权限的root账号
su -s

# 关闭防火墙

# 安装NodeJs

# 安装Git并拉取代码

# 进入demo1 目录

# 安装demo1依赖

# 把demo1跑起来

# 另开一个终端
# 本地验证，wetget获取

# 演示一下wetget 还没启动的demo2输出是什么

```

&emsp;使用浏览器访问你的云服务器demo1，然后修改NodeMCU demo1的代码，填写你的云服务器IP地址，就可以实现用你的云服务器控制你的硬件开关灯了。

### 把demo2跑起来
```bash

# 终止demo1，退出程序
[Ctrl + c]

# 安装 MongoDB

# 进入demo2 目录

# 安装demo2依赖

# 把demo2跑起来

# 另开一个终端
# 本地验证，wetget获取

```


&emsp;使用浏览器访问你的云服务器demo2，然后修改NodeMCU demo2的代码，填写你的云服务器IP地址并烧录程序，就可以实现用你的demo2跑起来了。


### 使用PM2
&emsp;大家可以看到，跑一个程序时，是无法做其它事的，直到`Ctrl + c`来结束程序，才能做其它事，一般我会别开一个终端来输入其它命令。当大家学习Linux基础时，就会学到可以把当前程序以后台运行，但我很少这样做，我更喜欢开多个终端。

&emsp;还有另一个问题，当你关闭终端时，会默认关闭当前程序。我一般喜欢使用`screen`命令来保持。而对于NodeJs程序，大家都喜欢使用PM2来管理程序，使其能一直运行并且能出现异常导致停止时能自动重启：

```bash
# 安装PM2

# 运行程序 


```

&emsp;这样，你的程序就能一直跑了。 是不是感觉还没会懂linux，没学懂就对了，因为我根本就没教，只是示范如何跑起来而已，要学习还得从基础打起，啃书实践一个都不能省：[linux基础](/posts/34982)






## 其它说明
- 在云服务器上阿里云质量技术更好，腾讯云性价比更高。
- 后继可以自行研究购买域名等操作，腾讯云本身有录制大量的[教学视频](https://cloud.tencent.com/edu/learning?from=gw.head)与[动手实验室](https://cloud.tencent.com/developer/labs)。
- 为了简单演示，所以登陆服务器使用密码登陆，一般更建议使用SSH密钥登陆，可自行学习。
- 用完腾讯云的新人价后，还可以去阿里云继续当“新人”，以新人价买。
- [Vultr 云服务器 限时活动，新人免费$100额度](https://www.vultr.com/?ref=8911389-6G)

